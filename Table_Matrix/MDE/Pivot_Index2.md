# üîç Pivot Matrix ‚Äì ‚ÄúWhich Table Do I Use for X?‚Äù

This is the **quick lookup sheet** for analysts:  
**Table ‚Üí What it contains ‚Üí What threats it‚Äôs good for ‚Üí Where to pivot next.**

| Table(s) | Category | What It Contains | Primary Threats / Use Cases | Key Pivots (Next Steps) |
|----------|----------|------------------|-----------------------------|--------------------------|
| **DeviceProcessEvents** | Endpoint | Every process start: filename, full command line, parent process, user, hashes, folders. | Execution, LOLBins, script abuse, initial payloads, ransomware staging, post-exploit tooling (PsExec, Mimikatz loaders, Cobalt Strike beacons). | ‚Üí DeviceNetworkEvents (did it talk out?) ‚Ä¢ ‚Üí DeviceFileEvents (what did it drop?) ‚Ä¢ ‚Üí DeviceImageLoadEvents (DLLs it loaded) ‚Ä¢ ‚Üí DeviceRegistryEvents (did it create persistence?) ‚Ä¢ ‚Üí DeviceLogonEvents (linked account activity). |
| **DeviceNetworkEvents** | Endpoint | Outbound network connections at process level: dest IP/URL/port, protocol, initiating process. | C2, scanning, lateral movement (SMB/RDP/WinRM), exfiltration over HTTP/HTTPS, beaconing patterns, internal recon. | ‚Üí DeviceProcessEvents (who initiated?) ‚Ä¢ ‚Üí ThreatIntelligenceIndicator (is IP/URL known bad?) ‚Ä¢ ‚Üí CommonSecurityLog / ASimNetworkSession (firewall/proxy view) ‚Ä¢ ‚Üí CloudAppEvents (if SaaS domains). |
| **DeviceFileEvents** | Endpoint | File create/modify/delete ops, paths, hashes, process that touched file. | Payload dropper activity, staging of tools, ransomware encryption, deployment of loaders, data staging prior to exfiltration. | ‚Üí DeviceProcessEvents (which process wrote it?) ‚Ä¢ ‚Üí DeviceFileCertificateInfo (is it signed/legit?) ‚Ä¢ ‚Üí DeviceImageLoadEvents (DLL loads from same path) ‚Ä¢ ‚Üí DeviceTvmSoftwareVulnerabilities (if file is installer/updater). |
| **DeviceRegistryEvents** | Endpoint | Registry write/delete: key, value name, data, process, account. | Persistence (Run/RunOnce, services, IFEO), credential/LSA tampering, enabling RDP, disabling security features. | ‚Üí DeviceProcessEvents (who wrote the key?) ‚Ä¢ ‚Üí DeviceLogonEvents (accounts tied to change) ‚Ä¢ ‚Üí DeviceEvents (ASR/AV events around same time). |
| **DeviceImageLoadEvents** | Endpoint | DLL and module loads by processes (path, hash, process). | DLL sideloading, in-memory injection hints, malicious modules, third-party libraries abused by attackers. | ‚Üí DeviceProcessEvents (process parent/child chain) ‚Ä¢ ‚Üí DeviceFileEvents (was DLL recently created?) ‚Ä¢ ‚Üí DeviceFileCertificateInfo (signed or shady cert?). |
| **DeviceLogonEvents** | Endpoint | Logon attempts: account, device, logon type, remote IP. | Lateral movement (RDP / SMB), credential guessing, service account misuse, anomalous admin logons. | ‚Üí DeviceNetworkEvents (port 3389/445 etc) ‚Ä¢ ‚Üí SigninLogs (cloud side of same user) ‚Ä¢ ‚Üí DeviceProcessEvents (post-logon suspicious processes). |
| **DeviceEvents** | Endpoint | Defender engine events: AV detections, ASR blocks, network protection, exploit guard. | Exploit attempts, malware detection, script blocks, tampering attempts, blocked behaviours. | ‚Üí DeviceProcessEvents (what process triggered detection?) ‚Ä¢ ‚Üí DeviceFileEvents (file that was blocked/quarantined) ‚Ä¢ ‚Üí SecurityAlert (alert created?) |
| **DeviceNetworkInfo** | Endpoint | Device IP addresses, NICs, network adapter details. | Recon for dual-homed hosts, locating devices by IP, mapping segments/subnets. | ‚Üí DeviceNetworkEvents (traffic from those IPs) ‚Ä¢ ‚Üí DeviceInfo (host role/tags) ‚Ä¢ ‚Üí ShadowITDiscoveryEvents (cloud usage per IP). |
| **DeviceFileCertificateInfo** | Endpoint | Code signing details for binaries: publisher, issuer, validity, thumbprint. | Malicious signed binaries, abused certs, fake publishers, expired cert abuse, supply-chain signed malware. | ‚Üí DeviceFileEvents (where that binary is deployed) ‚Ä¢ ‚Üí DeviceProcessEvents (execution instances) ‚Ä¢ ‚Üí ThreatIntelligenceIndicator (thumbprint/issuer in TI?). |
| **DeviceTvmSoftwareVulnerabilities** | Endpoint | CVEs per device/software from TVM. | Pre-attack exposure, vulnerable software, patching gaps enabling exploit-based attacks (RCE, privilege escalation). | ‚Üí DeviceInfo (prioritise high-value hosts) ‚Ä¢ ‚Üí SecurityAlert (if exploit alerts exist) ‚Ä¢ ‚Üí AzureActivity (patching changes). |
| **DeviceTvmSecureConfigurationAssessment** | Endpoint | Security baseline & config compliance (per device). | Hardening gaps, insecure configs, stuff attackers abuse (SMB signing off, weak RDP settings, disabled protections). | ‚Üí DeviceInfo (role + criticality) ‚Ä¢ ‚Üí DeviceEvents (proof of exploit attempts) ‚Ä¢ ‚Üí AzurePolicy / AzureActivity (config enforcement). |
| **EmailEvents** | Email | Each email: sender, recipient(s), subject, delivery action, high-level threat classification. | Phishing, malware campaigns, BEC patterns, noisy senders, targeted recipients. | ‚Üí EmailUrlInfo (URLs in those messages) ‚Ä¢ ‚Üí EmailAttachmentInfo (payload files) ‚Ä¢ ‚Üí SigninLogs (did recipient later show risky logons?) ‚Ä¢ ‚Üí DeviceNetworkEvents (click-through to URLs). |
| **EmailUrlInfo** | Email | URLs extracted from emails, linked to network message. | Credential harvesting pages, phishing kits, payload delivery URLs. | ‚Üí ThreatIntelligenceIndicator (URL reputation) ‚Ä¢ ‚Üí DeviceNetworkEvents (who connected to URL?) ‚Ä¢ ‚Üí CloudAppEvents (if URL is SaaS). |
| **EmailAttachmentInfo** | Email | File attachments in mail: filename, type, hash, threat verdict. | Macro docs, ISO/VHD loaders, weaponised archives, script droppers, EXE/DLL droppers. | ‚Üí DeviceFileEvents (hash/filename on endpoints) ‚Ä¢ ‚Üí DeviceProcessEvents (execution of dropped binaries) ‚Ä¢ ‚Üí DeviceFileCertificateInfo (if signed). |
| **SigninLogs** | Identity | AAD sign-in attempts: user, app, IP, device, location, risk. | Cloud account compromise, impossible travel, token theft, suspicious client apps, legacy auth usage. | ‚Üí DeviceLogonEvents (matching host/local logons) ‚Ä¢ ‚Üí CloudAppEvents (what SaaS apps they hit) ‚Ä¢ ‚Üí AzureActivity (admin ops by that user) ‚Ä¢ ‚Üí EmailEvents (compromised mailboxes). |
| **IdentityInfo / AAD user tables** | Identity | Account metadata: UPN, groups, roles, risk state. | High-value accounts, privileged roles, risky users, lateral movement potential. | ‚Üí SigninLogs (access patterns) ‚Ä¢ ‚Üí DeviceLogonEvents (where they log on) ‚Ä¢ ‚Üí SecurityIncident (incidents tied to that identity). |
| **CloudAppEvents** | Cloud | User activity in SaaS apps (logins, file access, admin changes, risky actions). | Shadow IT, risky SaaS use, suspicious sessions, anomalous admin behaviour, exfil via cloud storage. | ‚Üí CloudAppFileEvents (what files?) ‚Ä¢ ‚Üí SigninLogs (same user, same session) ‚Ä¢ ‚Üí DeviceNetworkEvents (endpoint C2/exfil to those SaaS domains). |
| **CloudAppFileEvents** | Cloud | File operations in SaaS (upload, download, share, sync). | Data exfiltration to personal/cloud storage, over-sharing, mass downloads prior to account compromise. | ‚Üí CloudAppEvents (session/activity context) ‚Ä¢ ‚Üí DeviceFileEvents (local staging) ‚Ä¢ ‚Üí SigninLogs (identity risk). |
| **CloudAppSecurityAlerts (MCAS Alerts)** | Cloud | Cloud App Security / MCAS alerts for risky behaviour. | Impossible travel, suspicious logins, exfil patterns, anomalous OAuth use. | ‚Üí SigninLogs (source of alert) ‚Ä¢ ‚Üí CloudAppEvents (underlying activity) ‚Ä¢ ‚Üí SecurityAlert/SecurityIncident (correlated on Sentinel side). |
| **AppGovernanceAlertEvents / PolicyEvents** | Cloud / OAuth | Alerts & policy hits for OAuth app behaviour. | Malicious/over-privileged OAuth apps, token abuse, app-based exfiltration. | ‚Üí ServicePrincipal / AAD App registrations ‚Ä¢ ‚Üí SigninLogs (which user consented) ‚Ä¢ ‚Üí CloudAppFileEvents (file access by app). |
| **ShadowITDiscoveryEvents** | Cloud / Shadow IT | Cloud services discovered via endpoint traffic and logs. | Unsanctioned SaaS, risky unknown services, exfil via personal cloud accounts. | ‚Üí CloudAppEvents (if sanctioned later) ‚Ä¢ ‚Üí DeviceNetworkEvents (traffic to those services) ‚Ä¢ ‚Üí Policy to sanction/block apps. |
| **AlertInfo** | Alerts (M365D) | High-level alerts raised by Microsoft 365 Defender products (MDE, MDI, MDO, etc.). | Any detection from MDE/MDO/MDI ‚Äì your ‚Äúwhat fired‚Äù list. | ‚Üí AlertEvidence (entities behind alert) ‚Ä¢ ‚Üí DeviceProcess/NetworkEvents (endpoint detail) ‚Ä¢ ‚Üí SecurityIncident (if correlated in Sentinel). |
| **AlertEvidence** | Alerts (M365D) | Entities (devices, users, files, IPs, URLs) linked to AlertId. | Explaining *who/what/where* for each alert, linking to endpoint & identity. | ‚Üí DeviceProcessEvents (for DeviceId/DeviceName) ‚Ä¢ ‚Üí DeviceNetworkEvents / DeviceFileEvents ‚Ä¢ ‚Üí SigninLogs (for AAD accounts). |
| **SecurityAlert** | Alerts (Sentinel) | Sentinel view of alerts from all connectors (MDE, AAD, MCAS, custom rules). | Consolidated alert surface for all data sources, detection tuning. | ‚Üí SecurityIncident (grouped incidents) ‚Ä¢ ‚Üí Underlying tables based on ProductName (MDE ‚Üí Device*, AAD ‚Üí SigninLogs, etc.). |
| **SecurityIncident** | Incidents (Sentinel) | Correlated alerts grouped into a case (incident). | Full campaigns, multi-host/multi-user intrusions, triage & IR workflows. | ‚Üí SecurityAlert (alerts in incident) ‚Ä¢ ‚Üí AlertInfo/AlertEvidence (M365D view) ‚Ä¢ ‚Üí All endpoint/identity tables for deeper investigation. |
| **ThreatIntelligenceIndicator** | TI | IP, URL, domain, hash indicators from threat intel feeds (internal + external). | Matching activity against known bad IOCs, TI-driven hunting, detection enrichment. | ‚Üí DeviceNetworkEvents (IP/URL) ‚Ä¢ ‚Üí DeviceFileEvents/ProcessEvents (hashes) ‚Ä¢ ‚Üí CommonSecurityLog / ASim* (network logs). |
| **CommonSecurityLog** | Network / Infra | Normalised network/security logs (firewalls, proxies, IDS/IPS, etc.). | Perimeter C2, scanning, blocked connections, exfil outside MDE scope. | ‚Üí DeviceNetworkEvents (host-level view) ‚Ä¢ ‚Üí ThreatIntelligenceIndicator (IOCs) ‚Ä¢ ‚Üí ASimNetworkSession/WebSession (normalised views). |
| **ASimNetworkSession / ASimWebSession** | Network (ASIM) | Normalised network / web traffic used by Sentinel analytics. | Correlation across multiple network sources, HTTP/S exfil, C2, DNS tunnels. | ‚Üí DeviceNetworkEvents (host tie-in) ‚Ä¢ ‚Üí ThreatIntelligenceIndicator ‚Ä¢ ‚Üí CloudAppEvents (same domains). |
| **SecurityEvent** | Windows Logs (if connected) | Raw Windows events (4624/4625 logon, 7045 service creation, etc.). | Classic Windows auth, service install persistence, GPO/LSA changes. | ‚Üí DeviceLogonEvents (MDE view of same behaviours) ‚Ä¢ ‚Üí DeviceProcessEvents (new services/exec). |
| **AzureActivity / AuditLogs** | Cloud Infra | Azure subscription-level changes, AAD config changes, admin ops. | Role changes, app registrations, policy changes, risky admin behaviour. | ‚Üí SigninLogs (who did it) ‚Ä¢ ‚Üí AppGovernance / ServicePrincipal tables ‚Ä¢ ‚Üí SecurityAlert / SecurityIncident (cloud incidents). |

---

Use this matrix as your **‚Äúbrain shortcut‚Äù**:

- Start from **what question you‚Äôre trying to answer**,  
- Go to the **primary table(s)**,  
- Then follow the **pivot chain** into endpoint, identity, cloud, and alert context.

You can drop this whole section into your **Ultimate Guide** or **Deep Dive** file as-is.
