# DeviceProcessEvents ‚Äì Full MITRE ATT&CK Mapping

> Strength Ratings:
> - ‚≠ê‚≠ê‚≠ê High-fidelity direct detection  
> - ‚≠ê‚≠ê Medium (needs correlation)  
> - ‚≠ê Context only  

---

## üß† Execution (TA0002)

| Technique ID | Technique Name | Strength | Why This Table Detects It | Example KQL |
|--------------|----------------|----------|----------------------------|-------------|
| **T1059** | Command & Scripting Interpreter | ‚≠ê‚≠ê‚≠ê | Captures PowerShell, CMD, WScript, CScript, Python, Ruby, Node, bash, sh execution + arguments | `DeviceProcessEvents | where FileName in~ ("powershell.exe","pwsh.exe","cmd.exe","wscript.exe","cscript.exe")` |
| **T1059.001** | PowerShell | ‚≠ê‚≠ê‚≠ê | Full command-line capture + parent process | `"powershell" in FileName or ProcessCommandLine` |
| **T1059.003** | Windows Command Shell | ‚≠ê‚≠ê‚≠ê | Detects cmd.exe invocation and suspicious switches | `FileName =~ "cmd.exe"` |
| **T1059.005** | Visual Basic | ‚≠ê‚≠ê‚≠ê | Detects WScript/CScript and macro-driven execution | `FileName in~ ("wscript.exe","cscript.exe")` |
| **T1059.006** | Python | ‚≠ê‚≠ê‚≠ê | Detects python.exe execution (common in Cobalt Strike loaders, cloud implants) | `FileName =~ "python.exe"` |
| **T1218** | Signed Binary Proxy Execution (LOLBins) | ‚≠ê‚≠ê‚≠ê | Full telemetry on Mshta, Rundll32, Regsvr32, InstallUtil, Certutil, Odbcconf | `FileName in~ ("mshta.exe","rundll32.exe","regsvr32.exe",...)` |
| **T1106** | Native API | ‚≠ê‚≠ê | Detects suspicious processes that load Win32 APIs but requires DLL load correlation | N/A |
| **T1204.002** | Malicious File Execution | ‚≠ê‚≠ê | Detects execution from Downloads/Temp/AppData | `FolderPath has "AppData"` |

---

## üõ† Persistence (TA0003)

| Technique | Name | Strength | Reason |
|-----------|------|----------|--------|
| **T1547.001** | Registry Run Keys | ‚≠ê‚≠ê | Detects persistent program setup when paired with RegistryEvents |
| **T1547.004** | Winlogon / Userinit | ‚≠ê‚≠ê | Detects modified parents launching suspicious children |
| **T1053.005** | Scheduled Task | ‚≠ê‚≠ê‚≠ê | Detects `schtasks.exe` execution & task registration processes |
| **T1543.003** | Windows Service | ‚≠ê‚≠ê‚≠ê | Detects service.exe launching malicious binaries |
| **T1574.002** | DLL Search Order Hijacking | ‚≠ê‚≠ê‚≠ê | Malicious DLL loaded via rundll32.exe / legitimate processes |

---

## üîê Credential Access (TA0006)

| Technique | Name | Strength | Reason |
|-----------|------|----------|--------|
| **T1003.001** | LSASS Dumping (via procdump, taskmgr, comsvcs) | ‚≠ê‚≠ê‚≠ê | Detects invocation of procdump.exe/taskmgr/dllhost with suspicious switches |
| **T1558** | Steal or Forge Kerberos Tickets (Mimikatz) | ‚≠ê‚≠ê | Detects execution of Mimikatz-like binary/loader processes |
| **T1555** | Credentials from Password Stores | ‚≠ê‚≠ê | Detects access tools launched for DPAPI decryption |

---

## üì° Discovery (TA0007)

| Technique | Name | Strength |
|-----------|------|----------|
| **T1082** | System Information Discovery | ‚≠ê‚≠ê‚≠ê |
| **T1087** | Account Discovery | ‚≠ê‚≠ê‚≠ê |
| **T1046** | Network Scanning (nmap, advanced port scanners) | ‚≠ê‚≠ê |
| **T1018** | Remote System Discovery | ‚≠ê‚≠ê |
| **T1083** | File/Directory Discovery | ‚≠ê‚≠ê‚≠ê |

---

## üèÉ‚Äç‚ôÇÔ∏è Lateral Movement (TA0008)

| Technique | Name | Strength | Reason |
|-----------|------|----------|--------|
| **T1021.001** | RDP | ‚≠ê‚≠ê | RDP client tools launched via command line |
| **T1021.002** | SMB / PsExec | ‚≠ê‚≠ê‚≠ê | Detects PsExec service binary creation + psexec.exe invocation |
| **T1055** | Process Injection | ‚≠ê‚≠ê | Requires correlation with module loads |
| **T1072** | Remote Services | ‚≠ê‚≠ê‚≠ê | Detects remote MMC/RDP tools |

---

## üéØ Collection (TA0009)

| Technique | Name |
|-----------|-------|
| **T1113** | Screen Capture Tools |
| **T1114** | Email Collection Tools |

---

## üì§ Exfiltration (TA0010)

| Technique | Name | Strength |
|-----------|-------|----------|
| **T1041** | Exfiltration Over C2 Channel | ‚≠ê‚≠ê‚≠ê |
| **T1567** | Exfiltration Over Web Services | ‚≠ê‚≠ê‚≠ê (requires DeviceNetworkEvents pivot) |

---

## üïπ Command & Control (TA0011)

| Technique | Name | Strength |
|-----------|-------|----------|
| **T1071.001** | Web C2 | ‚≠ê‚≠ê‚≠ê |
| **T1105** | Ingress Tool Transfer | ‚≠ê‚≠ê‚≠ê |
| **T1095** | Non-Application Protocol | ‚≠ê‚≠ê |

---

## üí• Impact (TA0040)

| Technique | Name |
|-----------|------|
| **T1486** | Ransomware Execution Processes |
| **T1490** | Stop Services, Kill Backups |

