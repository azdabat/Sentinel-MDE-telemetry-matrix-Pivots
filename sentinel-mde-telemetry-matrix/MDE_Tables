| Table                    | Source / Log Type                                                                            | Key Fields (for SOC)                                                                                                                                 | Primary Use / Attack Coverage                                                                                                                                                         | Typical Pivots & Example Ideas                                                                                                                                                                                                                                                                    |
| ------------------------ | -------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **DeviceProcessEvents**  | Defender for Endpoint → Sentinel                                                             | `Timestamp`, `DeviceName`, `FileName`, `ProcessCommandLine`, `ParentProcessName`, `FolderPath`, `AccountName`, `ProcessId`, `InitiatingProcessSHA1`  | Core endpoint process telemetry. Malware execution, LOLBins, persistence helpers, lateral tools (PsExec, wmiexec), webshell child shells, ransomware encryptors, UAC bypass patterns. | **Pivot:** from suspicious `FileName` or `ParentProcessName` to all occurrences. Join with `DeviceNetworkEvents` on `InitiatingProcessId` or hash to see C2. Join with `DeviceFileEvents` by hash/path to see dropped files. Group by `ParentProcessName` to build “allowed parents” baseline.    |
| **DeviceNetworkEvents**  | Defender for Endpoint                                                                        | `Timestamp`, `DeviceName`, `InitiatingProcessFileName`, `InitiatingProcessCommandLine`, `RemoteIP`, `RemotePort`, `RemoteUrl`, `LocalIP`, `Protocol` | Which process talks to which IP/URL/port. C2 beacons, exfil, scanning, SMB/RDP lateral, crypto-mining pools, webshell outbound.                                                       | Start from IP/domain → list of processes & hosts. Group by `InitiatingProcessFileName` to find abnormal owners of network traffic (e.g. `rundll32` speaking HTTP). Join to TI on IP/domain; join back to `DeviceProcessEvents` for ancestry and path.                                             |
| **DeviceFileEvents**     | Defender for Endpoint                                                                        | `Timestamp`, `DeviceName`, `ActionType`, `FileName`, `FolderPath`, `SHA1`, `InitiatingProcessFileName`, `InitiatingProcessCommandLine`               | File writes, renames, deletes. Ransomware (mass changes), droppers, scripts writing EXEs/DLLs into `%TEMP%`/`%APPDATA%`, data staging (big ZIP/7z/RAR).                               | Start from suspicious process → see what files it drops (filter by `InitiatingProcessFileName`). Start from path/hash → see which process created it. Group by `DeviceName`/5-minute buckets to detect huge spikes in file ops.                                                                   |
| **DeviceRegistryEvents** | Defender for Endpoint                                                                        | `Timestamp`, `DeviceName`, `RegistryKey`, `RegistryValueName`, `RegistryValueData`, `InitiatingProcessFileName`, `AccountName`                       | Registry edits, esp. persistence and security config. Run/RunOnce keys, services, IFEO, COM hijack, LSA providers, enabling RDP, disabling security.                                  | Start from known persistence paths (Run, RunOnce, `HKLM\SYSTEM\CurrentControlSet\Services`, IFEO, `HKLM\SYSTEM\CurrentControlSet\Control\Lsa`). Pivot to `DeviceProcessEvents` to see ancestry of the writer; then pivot from `RegistryValueData` path → `DeviceFileEvents` to see file creation. |
| **DeviceLogonEvents**    | Defender for Endpoint                                                                        | `Timestamp`, `DeviceName`, `AccountName`, `LogonType`, `LogonId`, `RemoteIP`, `IsLocalAdmin`, `AccountDomain`                                        | Local/remote logons. RDP (type 10), network logons (3), interactive (2), service (5). Lateral movement, admin misuse, brute force, suspicious service account interactive use.        | Group by `AccountName` to see unusual devices or logon types. Filter for `LogonType == 10` RDP or 3 network. Pivot from `RemoteIP` to see which clients are connecting widely. Join to `DeviceProcessEvents` on `AccountName` and time to see what they ran post-logon.                           |
| **DeviceEvents**         | Defender for Endpoint “misc” – AV, Exploit Guard, scheduled tasks, ASR, browser events, etc. | `Timestamp`, `DeviceName`, `ActionType`, `AdditionalFields`                                                                                          | AV detection/blocks, exploit attempts, scheduled task creation, script detections, macro events.                                                                                      | Filter `ActionType` for high-value events: `ScheduledTaskCreated`, `AntivirusDetection`, `ExploitGuardNetworkProtectionBlocked`, etc. Pivot from detection event → suspicious process, URL or file; then to other tables for full path.                                                           |
